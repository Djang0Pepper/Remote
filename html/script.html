$(function() {

            var isMaximumReached = function() {
                return (+$("#devicemax").val() <= +$("#devicenum").val());
            }

            var incr_device = function() {
                $('#devicenum').val( function(i, c) {
                    return ++c;
                });
            }

            var decr_device = function() {
                $('#devicenum').val( function(i, c) {
                    return --c;
                });
            }

            var delete_device = function() {
                $(this).closest('.panel .panel-primary').remove();
                decr_device();
            }

            var add_device = function() {

                if (!isMaximumReached()) {
                    incr_device();
                    var dev = $("#empty_device").children().clone(true,true);
                    dev.find('button.delete-device').click(delete_device);
                    var ph = dev.find('.panel-title');
                    var dn = dev.find('.device-name');
                    ph.text(ph.text().replace("{num}", $("#devicenum").val()));
                    dn.val(ph.text());
                    $("#devicelist").append(dev);
                } else {
                    $("#adddevice").addClass('hidden')
                }
            }

            if ( !isMaximumReached() ) {
                $("#adddevice").removeClass('hidden');
                $("#adddevice").click(add_device);
            }
        });